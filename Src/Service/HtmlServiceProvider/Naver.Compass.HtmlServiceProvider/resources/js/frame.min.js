"undefined"==typeof console&&(console={log:function(){},warn:function(){}});var protoNow={viewer:{viewerID:"#protoNowViewer",pageId:"#viewerPageContent",Frame:{},Contents:{}},action:{},widget:{Flicking:{}},util:{}};
protoNow.util={setCookie:function(e,t,r,o,n,i){var a=escape(e)+"="+escape(t);a+=r?"; EXPIRES="+r.toGMTString():"",a+=o?"; PATH="+o:"",a+=n?"; DOMAIN="+n:"",a+=i?"; SECURE":"",document.cookie=a},getCookie:function(e){var t=null;if(document.cookie){var r=document.cookie.split(escape(e)+"=");if(r.length>=2){var o=r[1].split(";");t=unescape(o[0])}}return t},initI18n:function(){i18n.init({getAsync:!1,debug:!1,useLocalStorage:!1,useCookie:!0,detectLngQS:"lang",resGetPath:"resources/locales/__lng__/__ns__.json",fallbackLng:["ko","en","zh","ja"]}).done(function(){$("[data-i18n]").i18n()})},getPageIdFromUrl:function(){var e=this.parseHash();return e.p},parseHash:function(){var e=(new URI).hash().replace("#","?"),t=new URI(e).search(!0);return _.extend({p:""},t)},getStartPage:function(e){var t=null;return e.startPage&&(t=this._searchPageNode(e.startPage,e.rootNodes)),_.isNull(t)&&(t=this._getFirstPageNode(e.rootNodes)),t},_searchPageNode:function(e,t){for(var r=0,o=t.length;r<o;r++){var n=t[r];if(n.url===e)return n;var i=n.children&&n.children.length>0;if(i){var a=protoNow.util._searchPageNode(e,n.children);if(a)return a}}return null},_getFirstPageNode:function(e){for(var t=0,r=e.length;t<r;t++){var o=e[t];if(o.url)return o;var n=o.children&&o.children.length>0;if(n){var i=protoNow.util._getFirstPageNode(o.children);if(i)return i}}return null},decodeEntities:function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e},toNumber:function(e){var t=(e+"").replace("px","");return t=(t+"").replace("%",""),t=parseInt(t,10)||0},isOnScreen:function(e){var t=$(window),r={top:t.scrollTop(),left:t.scrollLeft()};r.right=r.left+t.width(),r.bottom=r.top+t.height();var o=e.offset();return o.right=o.left+e.outerWidth(),o.bottom=o.top+e.outerHeight(),!(r.right<o.left||r.left>o.right||r.bottom<o.top||r.top>o.bottom)},isElementVisible:function(e){var t=$(window).scrollTop(),r=t+$(window).height(),o=$(e).offset().top,n=o+$(e).height();return n<=r&&o>=t},runLazyImage:function(e){var t=$(protoNow.viewer.pageId+" img[data-src]"),r=t.length;if(0===r)return void(e&&e());var o=0,n=function(){r===o&&e&&e()};t.load(function(){o++,n()}).error(function(){o++,$(this).attr("src","resources/images/blank.png"),n()}),t.each(function(){var e=$(this).data("src");return!e||void $(this).attr("src",e)})},UUID:function(){return uuid.v4()}},$.isMobile=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());
var Frame=Backbone.View.extend({events:{click:"_onClickBody",keyup:"_onKeyupBody","click #btnPrevPage":"_onClickPageMove","click #icoPrevPage":"_onClickPageMove","click #btnNextPage":"_onClickPageMove","click #icoNextPage":"_onClickPageMove","click #leftPanelControlButton":"_onClickLeftPanelControlButton","click #asidePanelControlButton":"_onClickAsidePanelControlButton","click #qrCodeButton":"_onClickQrCodeButton","click #fullScreenButton":"_onClickFullScreen","click #exitFullScreenButton":"_onClickExitFullScreen","click #highlightInteractiveButton":"_onClickHighlightActionWidget","click #deselectAllItems":"_onClickDeselectAllItems","click #QRcodeLayer .btn_close":"_onClickCloseQrCodeLayer","click #multiViewsControlButton":"_onClickFoldMultiViews","click #siteMapControlButton":"_onClickFoldSiteMap","click #pageNoteControlButton":"_onClickFoldPageNote","click #widgetNotesControlButton":"_onClickFoldWidgetNotes","click #foldPageList":"_onClickFoldPageListLayer","mouseleave .page_nav_area":"_hidePageListLayer"},initialize:function(e){this.$el=e.$el,this.oNoteContent=null,this._initVars(e.htDocumentData),this._assignElements(),this._setEvent(),this._initQRCode(),this._initShortUrl(),this._initCookies()},_assignElements:function(){this.welWindow=$(window),this.welBody=$("body"),this.welCurrentPageNo=$("#currentPageNo"),this.welTotalPageNo=$("#totalPageNo"),this.welBtnPrevPage=$("#btnPrevPage"),this.welBtnNextPage=$("#btnNextPage"),this.welShortUrl=$("#shortUrlText"),this.welShortUrlNoti=$("#shortUrlNoti"),this.welViewerFrameContainer=$("#viewerFrameContainer"),this.welViewerContentContainer=$("#viewerContentContainer"),this.welViewerPageIframe=$("#viewerPageIframe"),this.welLeftPanel=$("#leftPanelContainer"),this.welRightPanel=$("#rightPanelContainer"),this.welNotesPanel=$("#notesPanel"),this.welSitemapPanel=$("#sitemapPanel"),this.welMultiViewsPanel=$("#multiViewsPanel"),this.welPageNotePanel=$("#pageNotePanel"),this.welWidgetNotesPanel=$("#widgetNotesPanel"),this.welTopPanel=$("#topPanel"),this.welBtnLeftPanelCtrl=$("#leftPanelControlButton"),this.welBtnAsidePanelCtrl=$("#asidePanelControlButton"),this.welBtnHighlightWidget=$("#highlightInteractiveButton"),this.welBtnQrCode=$("#qrCodeButton"),this.welLayerQrCode=$("#QRcodeLayer"),this.welLayerPageList=$("#PageListLayer"),this.welLeftSplitBar=null,this.welRightSplitBar=null,this.nBottomBannerHeight=$("#download_banner").height(),this.nPanelTitleUnfold=60,this.notesPanelWidth=this.welNotesPanel.width()},_initVars:function(e){this._events=[],this._broadTargets=[];var t={isLeftPanelShow:protoNow.util.getCookie("isLeftPanelShow")||"true",isAsidePanelShow:protoNow.util.getCookie("isASidePanelShow")||"true",isMultiViewShow:protoNow.util.getCookie("isMultiViewShow")||"true",isSiteMapShow:protoNow.util.getCookie("isSiteMapShow")||"true",isPageNoteShow:protoNow.util.getCookie("isPageNoteShow")||"true",isWidgetNotesShow:protoNow.util.getCookie("isWidgetNotesShow")||"true"};$.extend(this,t),this._htDocumentData=$.extend({QRUrl:"",protoNowDownloadUrl:""},e)},_initCookies:function(){var e=protoNow.util.getCookie("isLeftPanelShow");"true"===e||null===e?this._showLeftPanel():this._hideLeftPanel();var t=protoNow.util.getCookie("isMultiViewShow");"true"===t||null===t?this._showMultiViewPanel():this._hideMultiViewPanel();var i=protoNow.util.getCookie("isSiteMapShow");"true"===i||null===i?this._showSiteMapPanel():this._hideSiteMapPanel();var o=protoNow.util.getCookie("isASidePanelShow");"true"===o||null===o?this.welBtnAsidePanelCtrl.addClass("on"):this.welBody.addClass("hidden_aside_panel");var n=protoNow.util.getCookie("isPageNoteShow");"true"===n||null===n?this._showPageNotePanel():this._hidePageNotePanel();var s=protoNow.util.getCookie("isWidgetNotesShow");"true"===s||null===s?this._showWidgetNotesPanel():this._hideWidgetNotesPanel(),"true"===protoNow.util.getCookie("highlightActionWidget")&&this.welBtnHighlightWidget.addClass("on")},_initQRCode:function(){var e=protoNow.util.getCookie("qrUrl");null!==e&&(e=decodeURI(e));var t=this._htDocumentData.QRUrl||e;""!==$.trim(t)&&void 0!==t&&null!==t?$("#QRImage").attr("src",t):this.welBtnQrCode.hide()},_initShortUrl:function(){var e=protoNow.util.getCookie("shortUrl");this.welShortUrl.val(e),""==e&&this.welShortUrlNoti.hide()},_initPageNo:function(){var e=$(".sitemapPageLink");this.welCurrentPageNo.empty().append(this._getCurrentPageNo(e)+1),this.welTotalPageNo.empty().append(e.length)},_initSplitter:function(){var e=this._getWindowSize(),t=249,i=248,o=t,n=i;this.welViewerFrameContainer.width(e.nWidth).height(e.nHeight).split({orientation:"vertical",limit:t,position:o+"px"}),this.welRightPanel.width(e.nWidth-o).height(e.nHeight).split({orientation:"vertical",limit:i,position:e.nWidth-(o+n)+"px"}),null===this.welLeftSplitBar&&(this.welLeftSplitBar=this.welViewerFrameContainer.find("> .vsplitter"),this.welLeftSplitBar.addClass("left_split_bar")),null===this.welRightSplitBar&&(this.welRightSplitBar=this.welRightPanel.find("> .vsplitter"),this.welRightSplitBar.addClass("right_split_bar"))},_setEvent:function(){$.isMobile?(this._changeViewPortScale(),this.welWindow.on("resize",$.proxy(this._changeViewPortScale,this))):this._initSplitter(),this.welWindow.on("resize",$.proxy(this._onResizeFrame,this)).trigger("resize"),this.welWindow.on("hashchange",$.proxy(this._onChangeHash,this)),window.childScrollHandler=function(e,t){$("iframe").each(function(i,o){e.target===o.contentWindow.document||$(o.contentWindow).height()<t||o.contentWindow.scrollTo(0,t)})},window.addEventListener?addEventListener("message",$.proxy(this._onReceiver,this),!1):attachEvent("onmessage",$.proxy(this._onReceiver,this)),this.on("page.rendered",$.proxy(this._onPageRender,this)).on("page.load.complete",$.proxy(this._onPageLoadComplete,this)).on("close.window",$.proxy(this._onCloseWindow,this)).on("page.event",$.proxy(this._onClickPage,this)).on("page.widgetNoteEvent",$.proxy(this._onClickWidgetNoteIcon,this)).on("location.href",$.proxy(this._onLocationHref,this))},_onClickPage:function(e){"click"===e.type&&this.welBody.trigger("click")},_onChangeHash:function(){var e=protoNow.util.getPageIdFromUrl(),t=this.getPageNameById(e,this._htDocumentData.sitemap.rootNodes);$("head title").text(t)},getPageNameById:function(e,t){for(var i=0,o=t.length;i<o;i++){if(t[i].url===e)return t[i].pageName;if(t[i].children)return this.getPageNameById(e,t[i].children)}},_onClickWidgetNoteIcon:function(e){var t=e.target;if("off"==e.action)this.oNoteContent.removeAllHighlightWidgetNote();else{var i=$("#widget_note_"+t);this.oNoteContent._highlightWidgetNote(i)}},_onClickPageMove:function(e){var t=e.target.id,i=$(".sitemapPageLink"),o=this.welCurrentPageNo.text()-1,n=this._getMovePageNo(t,o);$(i[n]).trigger("click")},_getCurrentPageNo:function(e){for(var t=0,i=$(".sitemapHighlight .sitemapPageLink").attr("data-nodeurl"),o=0,n=e.length;o<n;o++)if(i==$(e[o]).attr("data-nodeurl")){t=o;break}return t},_getMovePageNo:function(e,t){return"icoPrevPage"==e||"btnPrevPage"==e?t-=1:"icoNextPage"!=e&&"btnNextPage"!=e||(t+=1),t},_onKeyupBody:function(e){var t=e.keyCode;37==t?this.welBtnPrevPage.trigger("click"):39==t&&this.welBtnNextPage.trigger("click")},_onClickBody:function(e){var t=$(e.target);if(t.hasClass("dimmd")){if("block"!==t.css("display"))return;this._onClickCloseQrCodeLayer()}},_onClickCloseQrCodeLayer:function(){this.welBtnQrCode.removeClass("on"),this.welLayerQrCode.hide(),$(".dimmd").hide()},_onClickQrCodeButton:function(e){var t=$(e.currentTarget);t.hasClass("on")?t.removeClass("on"):(t.addClass("on"),this.welLayerQrCode.show(),$(".dimmd").show()),e.stopPropagation(),e.preventDefault()},_onClickExitFullScreen:function(){return this.welBody.removeClass("full_screen"),!1},_onClickFullScreen:function(){return this.welBody.addClass("full_screen"),!1},_onClickLeftPanelControlButton:function(){"true"===this.isLeftPanelShow?this._hideLeftPanel():this._showLeftPanel(),protoNow.util.setCookie("isLeftPanelShow",this.isLeftPanelShow)},_hideLeftPanel:function(){this.welBtnLeftPanelCtrl.removeClass("on"),this.welBody.addClass("hidden_left_panel"),this.isLeftPanelShow="false";var e=this.welViewerFrameContainer.width();this._resizeRightPanel(e)},_showLeftPanel:function(){this.welBtnLeftPanelCtrl.addClass("on"),this.welBody.removeClass("hidden_left_panel"),this.isLeftPanelShow="true";var e=this.welViewerFrameContainer.width()-this.welLeftPanel.width()-this.welLeftSplitBar.width();this._resizeRightPanel(e)},_resizeRightPanel:function(e){this.welRightPanel.width(e),"block"===this.welRightPanel.css("display")&&(e-=this.welNotesPanel.width(),this.welRightSplitBar.css("left",e)),this.welViewerContentContainer.width(e)},_onClickFoldSiteMap:function(e){"true"===this.isSiteMapShow?this._hideSiteMapPanel():this._showSiteMapPanel(),protoNow.util.setCookie("isSiteMapShow",this.isSiteMapShow)},_showSiteMapPanel:function(){this._checkLeftPanelState()?this.welMultiViewsPanel.css("height",""):this._resizePanel(this.welSitemapPanel),$("#siteMapControlButton").removeClass("on"),this.welLeftPanel.removeClass("hidden_site_map_panel"),this.isSiteMapShow="true"},_hideSiteMapPanel:function(){$("#siteMapControlButton").addClass("on"),this.welLeftPanel.addClass("hidden_site_map_panel"),this._checkLeftPanelState()?this._resizePanel(this.welMultiViewsPanel):this.welMultiViewsPanel.css("height",""),this.isSiteMapShow="false"},_onClickHighlightActionWidget:function(e){e.preventDefault(),this.welBtnHighlightWidget.toggleClass("on"),this.broadcast("toolbar.highlightActionWidget",this.welBtnHighlightWidget.hasClass("on")?"on":"off"),protoNow.util.setCookie("highlightActionWidget",this.welBtnHighlightWidget.hasClass("on"))},_onClickAsidePanelControlButton:function(e){e.preventDefault();var t=this.welBtnAsidePanelCtrl;"true"===this.isAsidePanelShow?(t.removeClass("on"),this.welBody.addClass("hidden_aside_panel"),this.oNoteContent.removeAllHighlightWidgetNote(),this.isAsidePanelShow="false"):(t.addClass("on"),this.welBody.removeClass("hidden_aside_panel"),this.isAsidePanelShow="true"),this.welBody.trigger("resize"),this.broadcast("toolbar.pageWidgetNote",t.hasClass("on")),protoNow.util.setCookie("isASidePanelShow",this.isAsidePanelShow)},of:function(e){return this._broadTargets=e,this},on:function(e,t){return this._events[e]=t,this},broadcast:function(e,t){var i=this._broadTargets.length>0?this._broadTargets:$("iframe");i.each($.proxy(function(i,o){this.emit(o,e,t)},this)),this._broadTargets=[]},emit:function(e,t,i){var o={sMessage:t,sValue:i};e.contentWindow.window.postMessage(JSON.stringify(o),"*")},_getWindowSize:function(){var e={nHeight:"innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,nWidth:"innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth};return e},_onResizeFrame:function(){var e=this._getWindowSize(),t=e.nHeight,i=e.nWidth;if(this.welViewerFrameContainer.height(t).width(i),this.welRightPanel.height(t),this.welNotesPanel.height(t),this.welViewerPageIframe.height(t-this.welTopPanel),"true"===this.isLeftPanelShow){var o=i-this.welLeftPanel.width()-this.welLeftSplitBar.width();this.welRightPanel.width(o);var n=this.welLeftPanel.height()-this.nPanelTitleUnfold-this.nBottomBannerHeight;"true"===this.isSiteMapShow&&"false"===this.isMultiViewShow&&this.welSitemapPanel.height(n),"false"===this.isSiteMapShow&&"true"===this.isMultiViewShow&&this.welMultiViewsPanel.height(n)}else this.welRightPanel.width(i);if("true"===this.isAsidePanelShow){this.welNotesPanel.width(this.notesPanelWidth);var s=this.welRightPanel.width()-this.welNotesPanel.width();this.welViewerContentContainer.width(s),this.welRightSplitBar.css("left",s+"px");var l=this.welLeftPanel.height()-this.nPanelTitleUnfold;"true"===this.isPageNoteShow&&"false"===this.isWidgetNotesShow&&this.welPageNotePanel.height(l),"false"===this.isPageNoteShow&&"true"===this.isWidgetNotesShow&&this.welWidgetNotesPanel.height(l),this.welNotesPanel.width(this.notesPanelWidth-1)}else"true"===this.isLeftPanelShow?this.welViewerContentContainer.width(this.welRightPanel.width()):this.welViewerContentContainer.width(i)},_onReceiver:function(e){var t=JSON.parse(e.data),i=t.message;if(t&&t.message)return this._events[i]?void this._events[i](t):void console.log("no such events : "+i)},getViewPortUrlData:function(){var e="";return e},navigate:function(e){(this.isOnMobileViewPort()||MultiViewer.isActivate())&&(this.welViewerPageIframe.height(0),e+=this.getViewPortUrlData()),$("iframe").each($.proxy(function(t,i){i.contentWindow.location.href=e?e:"about:blank"}))},_onLocationHref:function(e){var t=protoNow.util.parseHash();t.p=e.url,this.navigate("viewer.html#"+URI.buildQuery(t))},isOnMobileViewPort:function(){return $.isMobile&&this._htDocumentData.mobileViewport},_changeViewPortScale:function(e){if(this.isOnMobileViewPort())this.broadcast("viewport.data",this._htDocumentData.mobileViewport);else if(MultiViewer.isActivate()){var t;t=_.isNull(e.id)||_.isUndefined(e.id)?$(".frame"):$('.frame[data-cid="'+e.id+'"]'),t.each($.proxy(function(e,t){var i=_.clone(this._htDocumentData.mobileViewport);i.scale=$(t).width()/i.width*parseFloat($("#_scale_input").val()),i.id=$(t).attr("data-cid"),this.emit($(t).find("iframe")[0],"viewport.data",i)},this))}},_onPageLoadComplete:function(e){this._setPageNotes(e.pageNotes),$(".sitemapPageLink").parent().parent().removeClass("sitemapHighlight"),$('.sitemapPageLink[data-nodeurl="'+e.pageID+'"]').parent().parent().addClass("sitemapHighlight"),this._replaceHash(e.pageID),this.broadcast("toolbar.highlightActionWidget",this.welBtnHighlightWidget.hasClass("on")?"on":"off"),this.isOnMobileViewPort()?this._changeViewPortScale():(MultiViewer.isActivate()&&(_.isUndefined(e.id)||_.isNull(e.id)||this._changeViewPortScale(e)),this._initPageNo(),this.oNoteContent=new NoteContent(e))},_onPageRender:function(e){e.id||this.isOnMobileViewPort()&&this.welViewerPageIframe.css("height","100%")},_onCloseWindow:function(){window.open("","_self"),window.close()},_replaceHash:function(e){var t=protoNow.util.parseHash();t.p=e;var i="#"+URI.buildQuery(t),o=window.location.toString().split("#")[0];"undefined"!=typeof window.history.replaceState?window.history.replaceState(null,null,o+i):window.location.replace(o+i),$(window).trigger("hashchange")},_setPageNotes:function(e){e?$("#pageNotes").html(e):$("#pageNotes").html($.i18n.t("nav.nopage"))},_onClickDeselectAllItems:function(e){MultiViewer.deselectAllItems()},_onClickFoldMultiViews:function(e){"true"===this.isMultiViewShow?this._hideMultiViewPanel():this._showMultiViewPanel(),protoNow.util.setCookie("isMultiViewShow",this.isMultiViewShow)},_showMultiViewPanel:function(){this._checkLeftPanelState()?this.welSitemapPanel.css("height",""):this._resizePanel(this.welMultiViewsPanel),$("#multiViewsControlButton").removeClass("on"),this.welLeftPanel.removeClass("hidden_multi_views_panel"),this.isMultiViewShow="true"},_hideMultiViewPanel:function(){$("#multiViewsControlButton").addClass("on"),this.welLeftPanel.addClass("hidden_multi_views_panel"),this._checkLeftPanelState()?this._resizePanel(this.welSitemapPanel):this.welSitemapPanel.css("height",""),this.isMultiViewShow="false"},_checkLeftPanelState:function(){return!($(".hidden_multi_views_panel.hidden_site_map_panel").length>0)||(this.welSitemapPanel.css("height",""),this.welMultiViewsPanel.css("height",""),!1)},_resizePanel:function(e){var t=10,i=this.welViewerFrameContainer.height()-t-this.nBottomBannerHeight;e!=this.welSitemapPanel&&e!=this.welMultiViewsPanel||(i-=45),e.height(i)},_hidePageListLayer:function(){this.welLayerPageList.hide(),$("#foldPageList").removeClass("on")},_showPageListLayer:function(){this.welLayerPageList.show(),$("#foldPageList").addClass("on")},_onClickFoldPageListLayer:function(e){"block"===this.welLayerPageList.css("display")?this._hidePageListLayer():this._showPageListLayer()},_onClickFoldPageNote:function(e){"true"===this.isPageNoteShow?this._hidePageNotePanel():this._showPageNotePanel(),protoNow.util.setCookie("isPageNoteShow",this.isPageNoteShow)},_showPageNotePanel:function(){this._checkNotePanelState()?this.welWidgetNotesPanel.css("height",""):this._resizePanel(this.welPageNotePanel),$("#pageNoteControlButton").removeClass("on"),this.welNotesPanel.removeClass("hidden_page_note_panel"),this.isPageNoteShow="true"},_hidePageNotePanel:function(){$("#pageNoteControlButton").addClass("on"),this.welNotesPanel.addClass("hidden_page_note_panel"),this._checkNotePanelState()?this._resizePanel(this.welWidgetNotesPanel):this.welWidgetNotesPanel.css("height",""),this.isPageNoteShow="false"},_onClickFoldWidgetNotes:function(e){"true"===this.isWidgetNotesShow?this._hideWidgetNotesPanel():this._showWidgetNotesPanel(),console.log(this.isWidgetNotesShow),protoNow.util.setCookie("isWidgetNotesShow",this.isWidgetNotesShow)},_showWidgetNotesPanel:function(){this._checkNotePanelState()?this.welPageNotePanel.css("height",""):this._resizePanel(this.welWidgetNotesPanel),$("#widgetNotesControlButton").removeClass("on"),this.welNotesPanel.removeClass("hidden_widget_notes_panel"),this.broadcast("toolbar.pageWidgetNote",!0),this.isWidgetNotesShow="true"},_hideWidgetNotesPanel:function(){$("#widgetNotesControlButton").addClass("on"),this.welNotesPanel.addClass("hidden_widget_notes_panel"),this._checkNotePanelState()?this._resizePanel(this.welPageNotePanel):this.welPageNotePanel.css("height",""),this.broadcast("toolbar.pageWidgetNote",!1),this.isWidgetNotesShow="false"},_checkNotePanelState:function(){return!($(".hidden_page_note_panel.hidden_widget_notes_panel").length>0)||(this.welPageNotePanel.css("height",""),this.welWidgetNotesPanel.css("height",""),!1)},resetSplitArea:function(e){e===this.welRightPanel&&(this.notesPanelWidth=e.find("#notesPanel").width())}});
!function(t,i){var e=0,n=null,r=[],o=null;t.fn.split=function(l){function s(t){if("number"==typeof t)return t;if("string"==typeof t){var i=t.match(/^([0-9\.]+)(px|%)$/);if(i){if("px"==i[2])return+i[1];if("vertical"==p.orientation)return v*+i[1]/100;if("horizontal"==p.orientation)return f*+i[1]/100}}}var a=this.data("splitter");if(a)return a;var h,u,p=t.extend({limit:100,orientation:"horizontal",position:"50%",invisible:!1,onDragStart:t.noop,onDragEnd:t.noop,onDrag:t.noop},l||{});this.settings=p;var d,c=this.children();"vertical"==p.orientation?(h=c.first().addClass("left_panel"),u=h.next().addClass("right_panel"),d="vsplitter"):"horizontal"==p.orientation&&(h=c.first().addClass("top_panel"),u=h.next().addClass("bottom_panel"),d="hsplitter"),p.invisible&&(d+=" splitter-invisible");var v=this.width(),f=this.height(),g=e++;this.addClass("splitter_panel");var m,b=t("<div/>").addClass(d).bind("mouseenter touchstart",function(){n=g}).bind("mouseleave touchend",function(){n=null}).insertAfter(h),w=t.extend(this,{refresh:function(){var t=this.width(),i=this.height();v==t&&f==i||(v=this.width(),f=this.height(),w.position(m))},position:function(){return"vertical"==p.orientation?function(t,e){if(t===i)return m;m=s(t);var n=b.width(),r=n/2;if(p.invisible){var o=h.width(m).outerWidth();u.width(w.width()-o),b.css("left",o-r)}else{var o=h.width(m-r).outerWidth();u.width(w.width()-o-n),b.css("left",o)}return e||w.find(".splitter_panel").trigger("splitter.resize"),w}:"horizontal"==p.orientation?function(t,e){if(t===i)return m;m=s(t);var n=b.height(),r=n/2;if(p.invisible){var o=h.height(m).outerHeight();u.height(w.height()-o),b.css("top",o-r)}else{var o=h.height(m-r).outerHeight();u.height(w.height()-o-n),b.css("top",o)}return e||w.find(".splitter_panel").trigger("splitter.resize"),w}:t.noop}(),orientation:p.orientation,limit:p.limit,isActive:function(){return n===g},destroy:function(){w.removeClass("splitter_panel"),b.unbind("mouseenter"),b.unbind("mouseleave"),b.unbind("touchstart"),b.unbind("touchmove"),b.unbind("touchend"),b.unbind("touchleave"),b.unbind("touchcancel"),"vertical"==p.orientation?(h.removeClass("left_panel"),u.removeClass("right_panel")):"horizontal"==p.orientation&&(h.removeClass("top_panel"),u.removeClass("bottom_panel")),w.unbind("splitter.resize"),w.find(".splitter_panel").trigger("splitter.resize"),r.splice(g,1),e--,b.remove();for(var i=!1,n=r.length;n--;)if(null!==r[n]){i=!0;break}i||(t(document.documentElement).unbind(".splitter"),t(window).unbind("resize.splitter"),w.data("splitter",null),r=[],e=0)}});w.bind("splitter.resize",function(t){var i=w.position();"vertical"==w.orientation&&i>w.width()?i=w.width()-w.limit-1:"horizontal"==w.orientation&&i>w.height()&&(i=w.height()-w.limit-1),i<w.limit&&(i=w.limit+1),w.position(i,!0)});var z;return"vertical"==p.orientation?z=z>v-p.limit?v-p.limit:s(p.position):"horizontal"==p.orientation&&(z=z>f-p.limit?f-p.limit:s(p.position)),z<p.limit&&(z=p.limit),w.position(z,!0),0==r.length&&(t(window).bind("resize.splitter",function(){t.each(r,function(t,i){i.refresh()})}),t(document.documentElement).bind("mousedown.splitter touchstart.splitter",function(i){if(null!==n)return o=r[n],t('<div class="splitterMask"></div>').css("cursor",o.children().eq(1).css("cursor")).insertAfter(o),o.settings.onDragStart(i),!1}).bind("mouseup.splitter touchend.splitter touchleave.splitter touchcancel.splitter",function(i){o&&(protoNow.oFrame.resetSplitArea(o),t(".splitterMask").remove(),o.settings.onDragEnd(i),o=null)}).bind("mousemove.splitter touchmove.splitter",function(t){if(null!==o){var i=o.limit,e=o.offset();if("vertical"==o.orientation){var n=t.pageX;t.originalEvent&&t.originalEvent.changedTouches&&(n=t.originalEvent.changedTouches[0].pageX);var r=n-e.left;r<=o.limit?r=o.limit+1:r>=o.width()-i&&(r=o.width()-i-1),r>o.limit&&r<o.width()-i&&(o.position(r,!0),o.find(".splitter_panel").trigger("splitter.resize"),t.preventDefault())}else if("horizontal"==o.orientation){var l=t.pageY;t.originalEvent&&t.originalEvent.changedTouches&&(l=t.originalEvent.changedTouches[0].pageY);var s=l-e.top;s<=o.limit?s=o.limit+1:s>=o.height()-i&&(s=o.height()-i-1),s>o.limit&&s<o.height()-i&&(o.position(s,!0),o.find(".splitter_panel").trigger("splitter.resize"),t.preventDefault())}o.settings.onDrag(t)}})),r.push(w),w.data("splitter",w),w}}(jQuery);
var DeviceModel=Backbone.Model.extend({defaults:{category:"",vendor:"",model:"",width:0,height:0,pixelRatio:1,statusBarHeight:0,hasSoftKey:!1,softKeyHeight:0,isChecked:!1},initialize:function(e){this.set(e),this.on("change:isChecked",function(){this.get(e)})}}),MobileViewerReference=Backbone.Collection.extend({model:DeviceModel}),MobileSelectedViewer=Backbone.Collection.extend({model:DeviceModel}),MobileViewerList=Backbone.View.extend({events:{"click li.item_inr":"_onClickItem","click .category_name":"_onClickFoldItemList"},initialize:function(e){this.$el=e.$el,this._wUl=this.$el.find("ul").empty(),this.selectedCollection=e.selectedCollection,this._initList()},_initList:function(){var e=_.template('<li class="item_inr" data-cid="<%=cid%>" title="Real Resolution : <%=Math.ceil(width/pixelRatio)%>x<%=Math.ceil(height/pixelRatio)%> \nResolution : <%=width%>x<%=height%> \nPixel Ratio : <%=pixelRatio%>"><strong class="model_name">[<%=vendor%>] <%=model%></strong></li>'),t=_.template('<li class="item"><div class="category_name unfold" data-category-name="<%=category%>"><strong><%=category %></strong></div><ul class="list_model_series" data-device-category="<%=category %>" style="display:none"></ul></li>');this.collection.each($.proxy(function(i){var a=i.toJSON();a.cid=i.cid;var o=this._wUl.find('[data-device-category="'+a.category+'"]');0===o.length&&(this._wUl.append(t({category:a.category})),o=this._wUl.find('[data-device-category="'+a.category+'"]')),o.append(e(a))},this))},_updateSelectedItem:function(){var e=0;this.$el.find("li.item_inr").removeClass("checked"),this.selectedCollection.each($.proxy(function(t){var i=this.$el.find("li[data-cid="+t.cid+"]");i.addClass("checked"),e++},this)),0===e&&$(".btn_deselect_all_items").removeClass("on"),$("#viewerPageIframe").css("height","")},_onClickItem:function(e){var t=$(e.currentTarget).attr("data-cid"),i=this.collection.get(t);this.selectedCollection.get(t)?this.selectedCollection.remove(this.selectedCollection.get(t)):this.selectedCollection.add(i),this._updateSelectedItem()},_onClickFoldItemList:function(e){var t=$(e.currentTarget),i=t.attr("data-category-name"),a=$('.list_model_series[data-device-category="'+i+'"]');t.hasClass("unfold")?(t.removeClass("unfold"),a.slideDown(300)):(t.addClass("unfold"),a.slideUp(300))}}),Stage=Backbone.View.extend({V_WATCH_BAND_HEIGHT:90,WATCH_PANEL_OFFSET:40,events:{"click .device_wrap .btn_close":"_onClickDeselectItem","click .device_wrap .btn_rotate":"_onClickDeviceRotate"},initialize:function(e){this.$el=e.$el,this.collection.on("add",$.proxy(this.append,this)),this.collection.on("remove",$.proxy(this.remove,this)),this.collection.on("add remove",$.proxy(this.onChangeCollection,this)),$("body").on("DOMMouseScroll mousewheel",function(){$("body").stop()})},_onClickDeselectItem:function(e){var t=$(e.target).parents(".device_wrap").attr("data-cid");this.collection.remove(t),$('li.item_inr[data-cid="'+t+'"]').removeClass("checked")},_onClickDeviceRotate:function(e){var t=$(e.target).parents(".device_wrap"),i=_.isEqual(t.attr("data-device-vendor"),"Smart Watch"),a=_.isEqual(t.attr("data-device-orientation"),"landscape"),o=_.isEqual(t.attr("data-soft-key"),"true"),s=parseInt(t.attr("data-device-width"),10),c=parseInt(t.attr("data-device-height"),10),l=null,d=null;o&&(l=t.find(".soft_key").height(),d=t.find(".soft_key").width()),a?(t.attr("data-device-orientation","portrait").removeAttr("style").removeClass("device_orientation_is_landscape").find("> .watchband > .middle").css({width:s-this.WATCH_PANEL_OFFSET,height:this.V_WATCH_BAND_HEIGHT}).end().find("> .device_panel > .device_title").text(function(e,t){return t.replace(/\((\d{2,4})x(\d{2,4})\)$/,"($2x$1)")}).end().find("> .device_panel > .device_screen").css({width:s,height:c}),o&&t.find(".status_bar").css("right",0).end().find(".screen_cont").css({right:0,bottom:d}).end().find(".soft_key").css({top:c-d,left:0,height:d})):(t.attr("data-device-orientation","landscape").css("width",i?c+2*this.V_WATCH_BAND_HEIGHT:null).addClass("device_orientation_is_landscape").find("> .watchband > .middle").css({width:"auto",height:s-this.WATCH_PANEL_OFFSET}).end().find("> .device_panel > .device_title").text(function(e,t){return t.replace(/\((\d{2,4})x(\d{2,4})\)$/,"($2x$1)")}).end().find("> .device_panel > .device_screen").css({width:c,height:s}),o&&t.find(".status_bar").css("right",l).end().find(".screen_cont").css({right:l,bottom:0}).end().find(".soft_key").css({top:0,left:c-l,bottom:0,height:"100%"})),clearTimeout(this._scrollToPageBottom())},onChangeCollection:function(e,t){var i=$("#viewerPageIframe"),a=$("body");t.length>0?(a.addClass("multi_views"),i.hide()):(a.removeClass("multi_views"),i.show(),$("#viewerPageIframe").css("height",""),$("#rightPanel").css("overflow-y","hidden"))},remove:function(e){this.$el.find("[data-cid="+e.cid+"]").remove()},append:function(e){var t=this.$el,i=e.toJSON();i.cid=e.cid,i.mainFrameSrc=$("#viewerPageIframe")[0].contentWindow.location.href,i.width=Math.ceil(i.width/i.pixelRatio),i.height=Math.ceil(i.height/i.pixelRatio),i.statusBarHeight=Math.ceil(i.statusBarHeight/i.pixelRatio),i.softKeyHeight=Math.ceil(i.softKeyHeight/i.pixelRatio),i.WATCH_PANEL_OFFSET=this.WATCH_PANEL_OFFSET,t.append(this._buildDeviceStage(i)),clearTimeout(this._scrollToPageBottom())},_buildDeviceStage:function(e){var t="Apple"==e.vendor?" device_type_is_apple":"",i=_.template('<div class="device_wrap'+t+'"data-cid="<%=cid%>" data-device-category="<%=category%>" data-device-vendor="<%=vendor%>" data-device-width="<%=width%>"data-device-height="<%=height%>"data-soft-key="<%=hasSoftKey%>" data-device-orientation="portrait"><% if("Smart Watch"==category){ %><div class="watchband top"><div class="left"></div><div class="middle" style="width:<%=width-WATCH_PANEL_OFFSET%>px;"></div><div class="right"></div></div><%} %><div class="device_panel"><div class="device_title" title="[<%=vendor%>] <%=model%> (<%=width%>x<%=height%>)">[<%=vendor%>]<%=model%> (<%=width%>x<%=height%>)</div><div class="device_screen" style="width:<%=width%>px;height:<%=height%>px;"><div class="status_bar" style="height:<%=statusBarHeight%>px;"><span class="ico lft"></span><span class="ico cnt"></span><span class="ico rgt"></span></div><div class="screen_cont" style="top:<%=statusBarHeight%>px;bottom:<%if(hasSoftKey){%><%=softKeyHeight%>px;<%}%>"><iframe scrolling="yes" style="display: block;" frameborder="0" src="<%=mainFrameSrc%>" data-px-ratio="<%=pixelRatio%>" data-cid="<%=cid%>" class="_device_wrap" width="100%" height="100%"></iframe></div><% if(hasSoftKey){ %><div class="soft_key" style="height:<%=softKeyHeight%>px;"><span class="ico lft"></span><span class="ico cnt"></span><span class="ico rgt"></span></div><%} %><i class="home_button"></i></div><button type="button" class="btn btn_rotate">회전</button><button type="button" class="btn btn_close">닫기</button></div><% if("Smart Watch"==category){ %><div class="watchband bottom"><div class="left"></div><div class="middle" style="width:<%=width-WATCH_PANEL_OFFSET%>px;"></div><div class="right"></div></div><%} %></div>');return i(e)},_scrollToPageBottom:function(){var e=$("#viewerPageContainer"),t=$("#viewerContentContainer");setTimeout(function(){t.stop().animate({scrollTop:e.height()},500)},300)}}),MultiViewer={run:function(){var e=new MobileViewerReference,t=new MobileSelectedViewer;_.each(protoNow.DEVICE_MODEL_REFERENCE,function(t){e.add(t)});var i=new Stage({$el:$("#viewerPageMultiViews"),collection:t});i.listenTo(t,"remove",function(t){e.get({cid:t.get("cid")})}),new MobileViewerList({$el:$("#multiViewList"),oStage:i,selectedCollection:t,collection:e}),this.oSelectedMobileViewer=t},isActivate:function(){return this.oSelectedMobileViewer.length>0&&($("#deselectAllItems").addClass("on"),!0)},deselectAllItems:function(){$("#deselectAllItems").removeClass("on"),$(".item_inr").removeClass("checked"),_.each(_.clone(this.oSelectedMobileViewer.models),function(e){this.oSelectedMobileViewer.remove(e.cid)},this),$("#viewerPageIframe").css("height","")}};
var NoteContent=function(t){this.initialize.apply(this,arguments)};NoteContent.prototype={initialize:function(t){this.welWidgetNote=$("#WidgetNotes"),this._clearWidgetNote(),this._setWidgetNoteContent(t.widgets),protoNow.oFrame.broadcast("toolbar.pageWidgetNote",!$("#notesPanel").hasClass("hidden_widget_notes_panel"))},_setWidgetNoteEvent:function(){},_clickWidgetNote:function(t){if($(t.target).hasClass("on"))this.removeAllHighlightWidgetNote(),protoNow.oFrame.broadcast("toolbar.removeAllHighlightWidgetNote","off");else{var e=$(t.currentTarget);this._highlightWidgetNote(e);var i=t.target.id.replace("widget_note","div");protoNow.oFrame.broadcast("toolbar.highlightWidgetNotes",i)}return!1},_highlightWidgetNote:function(t){var e;this.removeAllHighlightWidgetNote(),(e=t.toggleClass("on").parents(".panel_content")).scrollTop(t.offset().top-e.offset().top+e.scrollTop())},removeAllHighlightWidgetNote:function(){$("#WidgetNotes li").removeClass("on")},_clearWidgetNote:function(){this.welWidgetNote.empty()},_setWidgetNoteContent:function(t){for(var e=0,i=0,o=t.length;i<o;i++)t[i].notes&&(this._renderWidgetNote(t[i]),e++);e>0?this._setWidgetNoteEvent():this._renderWidgetNote({id:"none",sNoteTitle:"",sNoteDesc:$.i18n.t("msg.no_widget_notes")})},_renderWidgetNote:function(t){$.template("widget_note",'<li id="widget_note_${id}" data-id="${id}" class="item_widget_note">   <div class="widget_note_title"  {{if sNoteTitle == ""}} style="display:none;" {{/if}} >${sNoteTitle}</div>   <div class="widget_note_cont">{{html sNoteDesc}}</div></li>'),t.sNoteTitle=this._getWidgetNoteTitle(t);var e=$.tmpl("widget_note",t);this.welWidgetNote.append($(e))},_getWidgetNoteTitle:function(t){var e=t.name||"";return e.length<=0&&(e="Shape"===t.type?$.i18n.t("shapeType.shape_context",{context:t.shapeType}):$.i18n.t("widgetType.widget_context",{context:t.type})),e}};
var protoNow=protoNow||{};protoNow.DEVICE_MODEL_REFERENCE=[{category:"Desktop",vendor:"Monitor",model:"2560 PX",width:1600,height:2560,pixelRatio:2},{category:"Desktop",vendor:"Monitor",model:"1280 PX",width:800,height:1280},{category:"Desktop",vendor:"Monitor",model:"1024 PX",width:768,height:1024},{category:"Smartphone",vendor:"Apple",model:"iPhone 6S, 6 Plus",width:1242,height:2208,pixelRatio:3,statusBarHeight:60},{category:"Smartphone",vendor:"Apple",model:"iPhone 6S, 6",width:750,height:1334,pixelRatio:2,statusBarHeight:40},{category:"Smartphone",vendor:"Apple",model:"iPhone 5S, 5",width:640,height:1136,pixelRatio:2,statusBarHeight:40},{category:"Smartphone",vendor:"Samsung",model:"Galaxy S6, Note5, 4",width:1440,height:2560,pixelRatio:4,statusBarHeight:75},{category:"Smartphone",vendor:"Samsung",model:"Galaxy S5, S4, Note 3",width:1080,height:1920,pixelRatio:3,statusBarHeight:100},{category:"Smartphone",vendor:"Samsung",model:"Galaxy S3, Note 2",width:720,height:1280,pixelRatio:2,statusBarHeight:50},{category:"Smartphone",vendor:"LG",model:"Optimus G3",width:1440,height:2560,pixelRatio:4,statusBarHeight:100,hasSoftKey:!0,softKeyHeight:168},{category:"Smartphone",vendor:"Google",model:"Nexus 5",width:1080,height:1920,pixelRatio:3,statusBarHeight:75,hasSoftKey:!0,softKeyHeight:144},{category:"Tablet",vendor:"Apple",model:"iPad Pro",width:2048,height:2732,pixelRatio:2},{category:"Tablet",vendor:"Apple",model:"iPad Air, Air 2",width:1536,height:2048,pixelRatio:2},{category:"Tablet",vendor:"Apple",model:"iPad 2, 1, mini",width:768,height:1024},{category:"Tablet",vendor:"Samsung",model:"Galaxy Tab S2, S",width:1536,height:2048,pixelRatio:2,statusBarHeight:50,hasSoftKey:!0,softKeyHeight:96},{category:"Tablet",vendor:"Samsung",model:"Galaxy Tab A, SPen",width:768,height:1024,statusBarHeight:50,hasSoftKey:!0,softKeyHeight:96},{category:"Tablet",vendor:"Google",model:"Nexus 7",width:1200,height:1824,pixelRatio:2,statusBarHeight:50,hasSoftKey:!0,softKeyHeight:96},{category:"Smart Watch",vendor:"Apple",model:"Watch 42mm",width:312,height:390},{category:"Smart Watch",vendor:"Apple",model:"Watch 38mm",width:272,height:340}];
var Sitemap=function(e){this.initialize.apply(this,arguments)};Sitemap.prototype={initialize:function(e){this.htDocumentData=e,this.generateSitemap(),this.setEvent(),this.setFirstNode()},_setViewerPage:function(e){var t=protoNow.util.parseHash();return t.p=e,"viewer.html#"+URI.buildQuery(t)},setEvent:function(){$(".sitemapPlusMinusLink").click($.proxy(this.onClickExpend,this)),$(".sitemapPageLink").click($.proxy(this.onClickPageNode,this))},setFirstNode:function(){var e=protoNow.util.getPageIdFromUrl(),t=this._setViewerPage(e);if(""===e){var a=protoNow.util.getStartPage(this.htDocumentData.sitemap);return void(a&&(document.title=a.pageName,protoNow.oFrame.navigate(t+a.url)))}protoNow.oFrame.navigate(t)},onClickPageNode:function(e){var t=$(e.currentTarget);$(".sitemapHighlight").removeClass("sitemapHighlight"),t.parent().parent().addClass("sitemapHighlight");var a=t.data("nodeurl");$("head title").text(t.data("nodename")),protoNow.oFrame.navigate(this._setViewerPage(a))},onClickExpend:function(e){var t=$(e.currentTarget);t.find("span").toggleClass("sitemapMinus").toggleClass("sitemapPlus"),t.find("span").hasClass("sitemapPlus")?t.closest("li").children("ul").slideUp(300):t.closest("li").children("ul").slideDown(300)},generateSitemap:function(){for(var e="<ul class='sitemapTree'>",t=this.htDocumentData.sitemap.rootNodes,a=0,i=t.length;a<i;a++)e+=this.generateNode(t[a],0);e+="</ul></div>",$("#sitemapTreePanel").html(e)},generateNode:function(e,t){var a=e.children&&e.children.length>0,i="";i=a?"<li class='sitemapNode sitemapExpandableNode'><div><div class='sitemapPageLinkContainer' style='margin-left:"+(15+17*t)+"px'><a class='sitemapPlusMinusLink'><span class='sitemapMinus'></span></a>":"<li class='sitemapNode sitemapLeafNode'><div><div class='sitemapPageLinkContainer' style='margin-left:"+(27+17*t)+"px'>";var s="Folder"===e.type;if(s||(i+='<a class="sitemapPageLink" data-nodename="'+_.escape(e.pageName)+'" data-nodeurl="'+e.url+'">'),i+="<span class='ico_sitemap_page",s&&(i+=" ico_sitemap_folder"),i+="'></span><span class='sitemapPageName'>",i+=protoNow.util.decodeEntities(e.pageName),i+="</span>",s||(i+="</a>"),i+="</div></div>",a){i+="<ul>";for(var n=0,o=e.children.length;n<o;n++){var l=e.children[n];i+=this.generateNode(l,t+1)}i+="</ul>"}return i+="</li>"}};
var SitemapLayer=function(e){this.initialize.apply(this,arguments)};SitemapLayer.prototype={initialize:function(e){this.welLayerPageList=$("#PageListLayer"),this.htDocumentData=e,this.generateSitemap(),this.setEvent()},_setViewerPage:function(e){var t=protoNow.util.parseHash();return t.p=e,"viewer.html#"+URI.buildQuery(t)},setEvent:function(){$(".sitemap_item").click($.proxy(this.onClickPageNode,this))},onClickPageNode:function(e){var t=$(e.currentTarget);this._hidePageListLayer();var a=t.data("nodeurl");$("head title").text(t.data("nodename")),protoNow.oFrame.navigate(this._setViewerPage(a))},generateSitemap:function(){for(var e="<ol class='sitemap_list'>",t=this.htDocumentData.sitemap.rootNodes,a=0,i=t.length;a<i;a++)e+=this.generateNode(t[a],0);e+="</ol>",this.welLayerPageList.html(e)},generateNode:function(e,t){var a=e.children&&e.children.length>0,i=['<li class="sitemap_node">'],n=e.url?'" data-nodeurl="'+e.url+'"':' style="display:none"';if(i.push('<a class="sitemap_item" data-nodename="'+_.escape(e.pageName)+'"'+n+">"),i.push(protoNow.util.decodeEntities(e.pageName)),i.push("</a>"),a)for(var s=0,r=e.children.length;s<r;s++){var o=e.children[s];i.push(this.generateNode(o,t+1))}return i.push("</li>"),i.join("")},_hidePageListLayer:function(){this.welLayerPageList.hide(),$("#foldPageList").removeClass("on")}};